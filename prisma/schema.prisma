generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model binh_luan {
  binh_luan_id   Int        @id @default(autoincrement())
  nguoi_dung_id  Int
  hinh_id        Int
  ngay_binh_luan DateTime   @default(now()) @db.DateTime(0)
  noi_dung       String     @db.VarChar(500)
  hinh_anh       hinh_anh   @relation(fields: [hinh_id], references: [hinh_id], onDelete: Cascade, map: "fk_bl_hinh")
  nguoi_dung     nguoi_dung @relation(fields: [nguoi_dung_id], references: [nguoi_dung_id], onDelete: Cascade, map: "fk_bl_nguoidung")

  @@index([hinh_id], map: "idx_bl_hinh")
  @@index([nguoi_dung_id], map: "idx_bl_nguoidung")
}

model hinh_anh {
  hinh_id       Int         @id @default(autoincrement())
  ten_hinh      String      @db.VarChar(255)
  duong_dan     String      @db.VarChar(500)
  mo_ta         String?     @db.VarChar(500)
  nguoi_dung_id Int
  binh_luan     binh_luan[]
  nguoi_dung    nguoi_dung  @relation(fields: [nguoi_dung_id], references: [nguoi_dung_id], onDelete: Cascade, map: "fk_hinh_nguoidung")
  luu_anh       luu_anh[]

  @@index([nguoi_dung_id], map: "idx_hinh_nguoidung")
}

model luu_anh {
  nguoi_dung_id Int
  hinh_id       Int
  ngay_luu      DateTime   @default(now()) @db.DateTime(0)
  hinh_anh      hinh_anh   @relation(fields: [hinh_id], references: [hinh_id], onDelete: Cascade, map: "fk_luu_hinh")
  nguoi_dung    nguoi_dung @relation(fields: [nguoi_dung_id], references: [nguoi_dung_id], onDelete: Cascade, map: "fk_luu_nguoidung")

  @@id([nguoi_dung_id, hinh_id])
  @@index([hinh_id], map: "idx_luu_hinh")
}

model nguoi_dung {
  nguoi_dung_id Int         @id @default(autoincrement())
  email         String      @unique(map: "email") @db.VarChar(255)
  mat_khau      String      @db.VarChar(255)
  ho_ten        String      @db.VarChar(255)
  tuoi          Int?        @db.UnsignedTinyInt
  anh_dai_dien  String?     @db.VarChar(500)
  vai_tro_id    Int         @default(2)
  binh_luan     binh_luan[]
  hinh_anh      hinh_anh[]
  luu_anh       luu_anh[]
  vai_tro       vai_tro     @relation(fields: [vai_tro_id], references: [vai_tro_id], map: "fk_nguoi_dung_vai_tro")

  @@index([vai_tro_id], map: "idx_vai_tro_id")
}

model vai_tro {
  vai_tro_id    Int          @id @default(autoincrement())
  ten_vai_tro   String       @unique(map: "ten_vai_tro") @db.VarChar(100)
  dien_giai     String?      @db.VarChar(255)
  kich_hoat     Boolean      @default(true)
  ngay_tao      DateTime     @default(now()) @db.DateTime(0)
  ngay_cap_nhat DateTime?    @default(now()) @db.DateTime(0)
  nguoi_dung    nguoi_dung[]

  @@index([ten_vai_tro], map: "idx_ten_vai_tro")
}
